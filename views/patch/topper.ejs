<style>
    /* Ensure the dropdowns have appropriate z-index for mobile view */
    #category-dropdown,
    #search-dropdown,
    #user-menu {
      z-index: 20;
    }
    #logout-modal {
      z-index: 50;
    }

    /* Ensure mobile dropdowns are hidden on desktop and vice versa */
    .md\\:hidden {
      display: none !important;
    }

    .hidden {
      display: none !important;
    }

    /* Adjustments to make sure dropdowns don't show on desktop */
    @media (min-width: 768px) {
      #mobile-nav {
        display: none !important;
      }

      #mobile-category-dropdown,
      #mobile-search-dropdown,
      #mobile-user-dropdown {
        display: none !important;
      }

      /* Hide the desktop navigation on mobile */
      #desktop-nav {
        display: none;
      }

      /* Ensure the mobile navigation is displayed */
      #mobile-nav {
        display: block;
      }
    }
</style>

<!-- Desktop Navigation (hidden on mobile) -->
<!-- Desktop Navigation (hidden on mobile) -->
<nav id="desktop-nav" class="nav-container flex items-center justify-between py-2 px-4 bg-black text-white md:hidden">
  <!-- Left Side - Category Menu -->
  <div class="relative">
    <button id="category-menu-btn" class="hover:text-orange-500 p-3">
      <i class="fas fa-bars"></i>
    </button>
    <div id="category-dropdown" class="hidden absolute left-0 mt-2 w-48 bg-black rounded-lg shadow-lg">
      <a href="/shop/allProducts?category=Men&sort=latest" class="block p-3 hover:text-orange-500">Men</a>
      <a href="/shop/allProducts?category=Women&sort=latest" class="block p-3 hover:text-orange-500">Women</a>
      <a href="/shop/allProducts?category=Couples&sort=latest" class="block p-3 hover:text-orange-500">Couple</a>
      <a href="/shop/allProducts?category=Sales&sort=latest" class="block p-3 hover:text-orange-500">Sale</a>
    </div>
  </div>

  <!-- Center - Logo and Name -->
  <div class="flex flex-col items-center justify-center space-y-1" style="padding-left: 10%;">
    <img src="/images/mylogo1.png" alt="Phoenix watches Logo" class="nav-logo w-15 max-h-10">
    <p class="text-white text-xl font-bold styled-text">Phoenix</p>
  </div>

  <!-- Right Side - Navigation Icons -->
  <div class="flex items-center">
    <a href="/" class="hover:text-orange-500 p-3">
      <i class="fas fa-home"></i>
    </a>
    <a href="/shop/allProducts" class="hover:text-orange-500 p-3">
      <i class="fas fa-store"></i>
    </a>
    <a href="/cart" class="hover:text-orange-500 p-3">
      <i class="fas fa-shopping-cart"></i>
    </a>
    <a href="/wishlist" class="hover:text-orange-500 p-3">
      <i class="fas fa-heart"></i>
    </a>
    
    <!-- Search Icon with Dropdown -->
    <div class="relative">
      <button id="search-icon" class="hover:text-orange-500 p-3">
        <i class="fas fa-search"></i>
      </button>
      <div id="search-dropdown" class="hidden absolute right-0 mt-2 w-72 rounded-lg p-2 shadow-lg bg-gray-800">
        <form action="/shop/allProducts" method="GET" class="flex items-center">
          <input type="text" name="search" placeholder="Search" 
                 class="bg-gray-800 text-white text-sm px-4 py-2 rounded-full w-full" />
        </form>
      </div>
    </div>
  
    <% if (name) { %>
    <!-- User Icon and Menu -->
    <div class="relative">
      <button id="user-icon" class="hover:text-orange-500 p-3">
        <i class="fas fa-user"></i>
      </button>
      <div id="user-menu" class="hidden absolute right-0 mt-2 w-48 bg-black text-white rounded-md p-2 shadow-lg">
        <a href="/profile/personal-info" class="block hover:text-orange-500 py-1">Profile</a>
        <button type="button" id="logout-button" class="block w-full text-left hover:text-orange-500 py-1">Logout</button>
      </div>
    </div>
    <% } else { %>
    <!-- Login Icon -->
    <a href="/login" class="hover:text-orange-500 p-3">
      <i class="fas fa-sign-in-alt"></i>
    </a>
    <% } %>
</nav>

<!-- Mobile Menu Toggle (Visible on mobile only) -->
<div class="md:hidden">
  <button id="menu-toggle" aria-label="Toggle Menu" class="p-2 text-white focus:outline-none">
    <i class="fas fa-bars w-6 h-6"></i>
  </button>
  
  <!-- Mobile Dropdown -->
  <div id="mobile-nav" class="hidden absolute top-12 left-12 right-0 w-56 bg-black text-white rounded-md shadow-lg z-50 flex flex-col space-y-2">
    <!-- Mobile Category -->
    <div>
      <button id="mobile-category-btn" class="block w-full text-left px-4 py-2 hover:text-orange-500 focus:outline-none">
        <i class="fas fa-bars"></i> Categories
      </button>
      <div id="mobile-category-dropdown" class="hidden bg-gray-800 rounded-md">
        <a href="/shop/allProducts?category=Men&sort=latest" class="block px-4 py-2 hover:text-orange-500">Men</a>
        <a href="/shop/allProducts?category=Women&sort=latest" class="block px-4 py-2 hover:text-orange-500">Women</a>
        <a href="/shop/allProducts?category=Couples&sort=latest" class="block px-4 py-2 hover:text-orange-500">Couples</a>
        <a href="/shop/allProducts?category=Sales&sort=latest" class="block px-4 py-2 hover:text-orange-500">Sale</a>
      </div>
    </div>

    <!-- Right Side - Navigation Icons -->
    <div class="flex flex-col items-start space-y-2">
      <a href="/" class="block px-4 py-2 hover:text-orange-500">
        <i class="fas fa-home"></i> Home
      </a>
      <a href="/shop/allProducts" class="block px-4 py-2 hover:text-orange-500">
        <i class="fas fa-store"></i> Shop
      </a>
      <a href="/cart" class="block px-4 py-2 hover:text-orange-500">
        <i class="fas fa-shopping-cart"></i> Cart
      </a>
      <a href="/wishlist" class="block px-4 py-2 hover:text-orange-500">
        <i class="fas fa-heart"></i> Wishlist
      </a>
    </div>

    <!-- Mobile Search -->
    <div class="flex flex-col space-y-2">
      <button id="mobile-search-btn" class="block w-full text-left px-4 py-2 hover:text-orange-500 focus:outline-none">
        <i class="fas fa-search"></i> Search
      </button>
      <div id="mobile-search-dropdown" class="hidden p-2 bg-gray-800">
        <form action="/shop/allProducts" method="GET">
          <input type="text" name="search" placeholder="Search" class="w-full px-4 py-2 rounded-full bg-gray-700 text-white" />
        </form>
      </div>
    </div>

    <!-- Mobile User Section -->
    <% if (name) { %>
    <div class="flex flex-col space-y-2">
      <button id="mobile-user-btn" class="block w-full text-left px-4 py-2 hover:text-orange-500 focus:outline-none">
        <i class="fas fa-user"></i> <%= name %>
      </button>
      <div id="mobile-user-dropdown" class="hidden bg-gray-800 rounded-md">
        <a href="/profile/personal-info" class="block px-4 py-2 hover:text-orange-500">Profile</a>
        <button id="logout-button-mobile" class="block w-full text-left px-4 py-2 hover:text-orange-500">Logout</button>
      </div>
    </div>
    <% } else { %>
    <a href="/login" class="block px-4 py-2 hover:text-orange-500">
      <i class="fas fa-sign-in-alt"></i> Login
    </a>
    <% } %>
  </div>

    <!-- Center - Logo and Name -->
    <div class="flex flex-col items-center justify-center space-y-1" style="padding-left: 10%;">
      <img src="/images/mylogo1.png" alt="Phoenix watches Logo" class="nav-logo w-15 max-h-10">
      <p class="text-white text-xl font-bold styled-text">Phoenix</p>
    </div>
    
</div>

<script>
  // Desktop Dropdowns (for category, search, and user menu)
  const categoryBtn = document.getElementById('category-menu-btn');
  const categoryDropdown = document.getElementById('category-dropdown');
  const searchIcon = document.getElementById('search-icon');
  const searchDropdown = document.getElementById('search-dropdown');
  const userIcon = document.getElementById('user-icon');
  const userMenu = document.getElementById('user-menu');
  const logoutButton = document.getElementById('logout-button');
  const logoutModal = document.getElementById('logout-modal');
  const cancelLogout = document.getElementById('cancel-logout');

  // Toggle Dropdowns on Desktop
  categoryBtn?.addEventListener('click', (e) => {
    e.stopPropagation();
    categoryDropdown.classList.toggle('hidden');
  });

  searchIcon?.addEventListener('click', (e) => {
    e.stopPropagation();
    searchDropdown.classList.toggle('hidden');
  });

  userIcon?.addEventListener('click', (e) => {
    e.stopPropagation();
    userMenu.classList.toggle('hidden');
  });

  // Show Logout Modal
  logoutButton?.addEventListener('click', (e) => {
    e.stopPropagation();
    logoutModal.classList.remove('hidden');
  });

  // Hide Logout Modal
  cancelLogout?.addEventListener('click', () => {
    logoutModal.classList.add('hidden');
  });

  // Close dropdowns when clicking outside on desktop
  document.addEventListener('click', (event) => {
    if (!categoryBtn.contains(event.target) && !categoryDropdown.contains(event.target)) {
      categoryDropdown.classList.add('hidden');
    }
    
    if (!searchIcon.contains(event.target) && !searchDropdown.contains(event.target)) {
      searchDropdown.classList.add('hidden');
    }
    
    if (!userIcon.contains(event.target) && !userMenu.contains(event.target)) {
      userMenu.classList.add('hidden');
    }
  });

  // Mobile Menu Toggle
  const menuToggle = document.getElementById('menu-toggle');
  const mobileNav = document.getElementById('mobile-nav');
  const mobileCategoryBtn = document.getElementById('mobile-category-btn');
  const mobileCategoryDropdown = document.getElementById('mobile-category-dropdown');
  const mobileSearchBtn = document.getElementById('mobile-search-btn');
  const mobileSearchDropdown = document.getElementById('mobile-search-dropdown');
  const mobileUserBtn = document.getElementById('mobile-user-btn');
  const mobileUserDropdown = document.getElementById('mobile-user-dropdown');

  // Mobile menu toggle
  menuToggle.addEventListener('click', () => {
    mobileNav.classList.toggle('hidden');
  });

  // Toggle Category Dropdown on Mobile
  mobileCategoryBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileCategoryDropdown.classList.toggle('hidden');
  });

  // Toggle Search Dropdown on Mobile
  mobileSearchBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileSearchDropdown.classList.toggle('hidden');
  });

  // Toggle User Dropdown on Mobile
  mobileUserBtn?.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileUserDropdown.classList.toggle('hidden');
  });

  // Hide Dropdowns when clicking outside on mobile
  document.addEventListener('click', (e) => {
    if (!mobileCategoryBtn.contains(e.target)) {
      mobileCategoryDropdown.classList.add('hidden');
    }
    if (!mobileSearchBtn.contains(e.target)) {
      mobileSearchDropdown.classList.add('hidden');
    }
    if (!mobileUserBtn?.contains(e.target)) {
      mobileUserDropdown.classList.add('hidden');
    }
  });
</script>

