<style>
  /* Ensure the dropdowns have appropriate z-index for mobile view */
  #category-dropdown,
  #search-dropdown,
  #user-menu {
    z-index: 20;
  }
  #logout-modal {
    z-index: 50;
  }

  /* Ensure mobile dropdowns are hidden on desktop and vice versa */
  .md\\:hidden {
    display: none !important;
  }

  .hidden {
    display: none !important;
  }

  /* Adjustments to make sure dropdowns don't show on desktop */
  @media (min-width: 768px) {
    #mobile-nav {
      display: none !important;
    }

    #mobile-category-dropdown,
    #mobile-search-dropdown,
    #mobile-user-dropdown {
      display: none !important;
    }
  }
</style>

<script>
  // Desktop Dropdowns (for category, search, and user menu)
  const categoryBtn = document.getElementById('category-menu-btn');
  const categoryDropdown = document.getElementById('category-dropdown');
  const searchIcon = document.getElementById('search-icon');
  const searchDropdown = document.getElementById('search-dropdown');
  const userIcon = document.getElementById('user-icon');
  const userMenu = document.getElementById('user-menu');
  const logoutButton = document.getElementById('logout-button');
  const logoutModal = document.getElementById('logout-modal');
  const cancelLogout = document.getElementById('cancel-logout');

  // Toggle Dropdowns on Desktop
  categoryBtn?.addEventListener('click', (e) => {
    e.stopPropagation();
    categoryDropdown.classList.toggle('hidden');
  });

  searchIcon?.addEventListener('click', (e) => {
    e.stopPropagation();
    searchDropdown.classList.toggle('hidden');
  });

  userIcon?.addEventListener('click', (e) => {
    e.stopPropagation();
    userMenu.classList.toggle('hidden');
  });

  // Show Logout Modal
  logoutButton?.addEventListener('click', (e) => {
    e.stopPropagation();
    logoutModal.classList.remove('hidden');
  });

  // Hide Logout Modal
  cancelLogout?.addEventListener('click', () => {
    logoutModal.classList.add('hidden');
  });

  // Close dropdowns when clicking outside on desktop
  document.addEventListener('click', (event) => {
    if (!categoryBtn.contains(event.target) && !categoryDropdown.contains(event.target)) {
      categoryDropdown.classList.add('hidden');
    }
    
    if (!searchIcon.contains(event.target) && !searchDropdown.contains(event.target)) {
      searchDropdown.classList.add('hidden');
    }
    
    if (!userIcon.contains(event.target) && !userMenu.contains(event.target)) {
      userMenu.classList.add('hidden');
    }
  });

  // Mobile Menu Toggle
  const menuToggle = document.getElementById('menu-toggle');
  const mobileNav = document.getElementById('mobile-nav');
  const mobileCategoryBtn = document.getElementById('mobile-category-btn');
  const mobileCategoryDropdown = document.getElementById('mobile-category-dropdown');
  const mobileSearchBtn = document.getElementById('mobile-search-btn');
  const mobileSearchDropdown = document.getElementById('mobile-search-dropdown');
  const mobileUserBtn = document.getElementById('mobile-user-btn');
  const mobileUserDropdown = document.getElementById('mobile-user-dropdown');

  // Mobile menu toggle
  menuToggle.addEventListener('click', () => {
    mobileNav.classList.toggle('hidden');
  });

  // Toggle Category Dropdown on Mobile
  mobileCategoryBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileCategoryDropdown.classList.toggle('hidden');
  });

  // Toggle Search Dropdown on Mobile
  mobileSearchBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileSearchDropdown.classList.toggle('hidden');
  });

  // Toggle User Dropdown on Mobile
  mobileUserBtn?.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileUserDropdown.classList.toggle('hidden');
  });

  // Hide Dropdowns when clicking outside on mobile
  document.addEventListener('click', (e) => {
    if (!mobileCategoryBtn.contains(e.target)) {
      mobileCategoryDropdown.classList.add('hidden');
    }
    if (!mobileSearchBtn.contains(e.target)) {
      mobileSearchDropdown.classList.add('hidden');
    }
    if (!mobileUserBtn?.contains(e.target)) {
      mobileUserDropdown.classList.add('hidden');
    }
  });
</script>

